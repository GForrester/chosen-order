/* Chosen Order v1.0.0 | (c) 2013 by Tristan Jahier, http://tristan-jahier.fr */
(function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a=function(){function a(){}var b,d,e,f,g,h,i;return b={invalid_select_element:"ChosenOrder::{{function}}: first argument must be a valid HTML Multiple Select element that has been Chosenified!",invalid_selection_array:"ChosenOrder::{{function}}: second argument must be an Array!",unreachable_chosen_container:'ChosenOrder::{{function}}: could not find the Chosen UI container! To solve the problem, try adding an "id" attribute to your <select> element.'},g=function(a,b,c){return c.insertBefore(a,c.children[b].nextSibling)},d=function(a){var b,c,d,e,f,g,h,i;for(b=[],f=0,h=a.length;h>f;f++)if(c=a[f],b.push(c),"OPTGROUP"===c.nodeName.toUpperCase())for(e=Array.prototype.filter.call(c.childNodes,function(a){return"OPTION"===a.nodeName.toUpperCase()}),g=0,i=e.length;i>g;g++)d=e[g],b.push(d);return b},i=function(a){return null!==a&&"undefined"!=typeof a&&"SELECT"===a.nodeName&&a.multiple},f=function(a){return""!==a.id?document.getElementById(a.id.replace(/-/g,"_")+"_chosen"):searchChosenUIContainer(a)},h=function(a){return null!=f(a)},e=function(a){var b,d,e,f;for(e=this.children,b=0;b<e.length;)d=e[b],f=d.getAttribute("value"),c.call(a,f)>=0?(d.selected=!0,d.setAttribute("selected","")):(d.selected=!1,d.removeAttribute("selected")),b++;return triggerEvent(this,"chosen:updated")},a.getSelectionOrder=function(a){var c,e,g,h,j,k,l,m,n,o;if("undefined"!=typeof getDOMElement&&null!==getDOMElement&&(a=getDOMElement(a)),l=[],!i(a))return console.error(b.invalid_select_element.replace("{{function}}","getSelectionOrder")),l;if(e=f(a),null==e)return console.error(b.unreachable_chosen_container.replace("{{function}}","getSelectionOrder")),l;for(c=e.querySelectorAll(".search-choice"),n=0,o=c.length;o>n;n++)h=c[n],g=h.querySelectorAll(".search-choice-close")[0],null!=g&&(m=g.getAttribute(this.relAttributeName)),k=Array.prototype.filter.call(a.childNodes,function(a){return"OPTION"===a.nodeName||"OPTGROUP"===a.nodeName}),k=d(k),j=k[m],l.push(j.value);return l},a.setSelectionOrder=function(a,c,d){var h,j,k,l,m,n,o,p,q,r,s;if("undefined"!=typeof getDOMElement&&null!==getDOMElement&&(a=getDOMElement(a)),!i(a))return void console.error(b.invalid_select_element.replace("{{function}}","setSelectionOrder"));if(k=f(a),null==k)return void console.error(b.unreachable_chosen_container.replace("{{function}}","setSelectionOrder"));if(c instanceof Array){for(c=c.map(Function.prototype.call,String.prototype.trim),null!=d&&d===!0&&e.call(a,c),s=[],l=q=0,r=c.length;r>q;l=++q)m=c[l],o=Array.prototype.indexOf.call(a,a.querySelector('option[value="'+m+'"]')),j=k.querySelectorAll(".search-choice"),p=this.relAttributeName,n=Array.prototype.filter.call(j,function(a){return null!=a.querySelector("a.search-choice-close["+p+'="'+o+'"]')})[0],h=k.querySelector("ul.chosen-choices"),s.push(g(n,l,k.querySelector("ul.chosen-choices")));return s}return console.error(b.invalid_selection_array.replace("{{function}}","setSelectionOrder"))},a}(),Element.addMethods({getSelectionOrder:function(a){return ChosenOrder.getSelectionOrder(a)},setSelectionOrder:function(a,b,c){return ChosenOrder.setSelectionOrder(a,b,c)}}),this.ChosenOrder=function(a){function c(){return b=c.__super__.constructor.apply(this,arguments)}return e(c,a),c.relAttributeName="rel",parent.searchChosenUIContainer=function(a){return a.next(".chosen-container.chosen-container-multi")},parent.triggerEvent=function(a,b){return Event.fire($(a),b)},c}(a)}).call(this);